# env: buildstock-2023.05.0
# Please check: n=100, use timestep, else monthly timeseries_frequency
schema_version: '0.3'
os_version: 3.6.1
buildstock_directory: ../ # Relative to this file or absolute
project_directory: project_national # Relative to buildstock_directory
output_directory: /projects/abctypol/largeee/test_runs/medium_run_category_7_20230824/
# weather_files_url: https://data.nrel.gov/system/files/156/BuildStock_TMY3_FIPS.zip
weather_files_path: /shared-projects/buildstock/weather/BuildStock_TMY3_FIPS.zip

sampler:
  type: precomputed
  args:
    sample_file: /projects/abctypol/largeee/buildstocks/buildstock_2m_20230809.csv #../buildstock_100_20230609.csv # relative to file

baseline:
  n_buildings_represented: 138765649 # American Community Survey 2021 5-year, does not include AK, HI, and territories
  skip_sims: true

eagle:
  n_jobs: 600
  minutes_per_sim: 2
  account: abctypol
  postprocessing:
    time: 2880
    n_workers: 32
    node_memory_mb: 180224
  sampling:
    time: 60

# eagle:
#   n_jobs: 50
#   minutes_per_sim: 4
#   account: abctypol
#   postprocessing:
#     time: 80
#     n_workers: 20
#   sampling:
#     time: 5

# eagle:
#   n_jobs: 1
#   minutes_per_sim: 4
#   account: abctypol
#   postprocessing:
#     time: 20
#     n_workers: 1
#   sampling:
#     time: 5

# postprocessing:
#   keep_individual_timeseries: false
#   aws:
#     region_name: us-west-2
#     s3:
#       bucket: largeee
#       prefix: test_runs
#     athena:
#       glue_service_role: service-role/AWSGlueServiceRole-default
#       database_name: largeee_test_runs
#       max_crawling_time: 1200

postprocessing:
  keep_individual_timeseries: false
  aws:
    region_name: us-west-2
    s3:
      bucket: largeee
      prefix: largeee_runs
    athena:
      glue_service_role: service-role/AWSGlueServiceRole-default
      database_name: largeee_runs
      max_crawling_time: 1200
      
workflow_generator:
  type: residential_hpxml
  args:
    build_existing_model:
      simulation_control_timestep: 60
      simulation_control_run_period_begin_month: 1
      simulation_control_run_period_begin_day_of_month: 1
      simulation_control_run_period_end_month: 12
      simulation_control_run_period_end_day_of_month: 31
      simulation_control_run_period_calendar_year: 2007

    emissions:
      - scenario_name: LRMER_HighRECost_2030boxavg
        type: CO2e
        elec_folder: data/cambium/2022/LRMER_HighRECost_2030boxavg
        gas_value: 147.3
        propane_value: 177.8
        oil_value: 195.9

      - scenario_name: LRMER_LowRECost_2030boxavg
        type: CO2e
        elec_folder: data/cambium/2022/LRMER_LowRECost_2030boxavg
        gas_value: 147.3
        propane_value: 177.8
        oil_value: 195.9

      - scenario_name: LRMER_MidCase_2030boxavg
        type: CO2e
        elec_folder: data/cambium/2022/LRMER_MidCase_2030boxavg
        gas_value: 147.3
        propane_value: 177.8
        oil_value: 195.9

    utility_bills:
      - scenario_name: Utility Rates - Fixed + Variable
        simple_filepath: data/simple_rates/State.tsv

    simulation_output_report:
      timeseries_frequency: monthly 
      include_timeseries_total_consumptions: true
      include_timeseries_fuel_consumptions: true
      include_timeseries_end_use_consumptions: true
      include_timeseries_emissions: true
      include_timeseries_total_loads: false

    reporting_measures:
      - measure_dir_name: QOIReport

    server_directory_cleanup:
      retain_in_idf: false
      retain_schedules_csv: false

### -- Upgrades ---
# Category 7:  Heat Pumps with Electric Backup and Light Touch Envelope
upgrades:
  - upgrade_name: EnergyStar ducted ASHP w/ elec backup - existing elec + light touch envelope
    # Category 5, Measure 1 + Category 2, Measure 1
      #ASHP
    package_apply_logic: &ducted_ASHP_elec_backup_existing_elec
      - HVAC Has Ducts|Yes
      - Heating Fuel|Electricity
      - or: &not_ASHP_greater_than_SEER_16_9_HSPF
        - not: HVAC Cooling Efficiency|Ducted Heat Pump
        - HVAC Heating Efficiency|ASHP, SEER 10, 6.2 HSPF
        - HVAC Heating Efficiency|ASHP, SEER 13, 7.7 HSPF
        - HVAC Heating Efficiency|ASHP, SEER 15, 8.5 HSPF

    options:

      - &ducted_ASHP_EnergyStar_elec_backup
        option: HVAC Heating Efficiency|ASHP, SEER 16, 9.2 HSPF 
        costs: &costs_ashp_ducted_SEER_16_9-2_HSPF
        # Source: Custom regression by Brennan Less. Ducted heat pump project costs were regressed on nameplate tons and HSPF,
        # from data described in in Less et al. https://doi.org/10.20357/B7FP4D. January 2019 $ inflated to April 2023 $ using 1.21 factor.
        # Ducted ASHP regression n=317. Implicitly includes electrical upgrades and electric backup.
          - value: 4821.83 # for HSPF 9.2
            multiplier: Fixed (1)
          - value: 167.64
            multiplier: Size, Heating System Primary (kBtu/h)
        lifetime: &lifetime_ducted_ASHP_elec_backup 15

      - &HP_cooling_efficiency_ducted
        option: HVAC Cooling Efficiency|Ducted Heat Pump

      - &100_percent_conditioned
        option: HVAC Cooling Partial Space Conditioning|100% Conditioned

      #Attic floor insulation up to IECC 2021 levels for homes with vented attics with R-13 or less insulation
      - &attic_insulation_IECC_CZ1A
        option: Insulation Ceiling|R-30
        apply_logic:
          - ASHRAE IECC Climate Zone 2004|1A
          - Geometry Attic Type|Vented Attic
          - or:
            - Insulation Ceiling|Uninsulated
            - Insulation Ceiling|R-7
            - Insulation Ceiling|R-13
            - Insulation Ceiling|R-19
        costs:
          - value: 0.0482 # $/(ft^2 * Delta R-value), from original REMDB xlsx for blown cellulose (0.0154+0.019)
                          # apply inflation factor 1.4 (Jan 2010 to Apr 2023) to 0.0344 https://www.bls.gov/data/inflation_calculator.htm
            multiplier: Floor Area, Attic * Insulation Increase (ft^2 * Delta R-value)
          - value: 0.2163 # $/(ft^2), from original REMDB xlsx for blown cellulose (0.1505+0.004)
                          # apply inflation factor 1.4 (Jan 2010 to Apr 2023) to 0.1545
            multiplier: Floor Area, Attic (ft^2)
        lifetime: 60 # years effective useful life for opaque envelope components, from https://www.nyserda.ny.gov/-/media/Files/Programs/energy-code-training/Residential-Cost-Analysis-Report.pdf 
      - &attic_insulation_IECC_CZ2A-2B-3A-3B-3C
        option: Insulation Ceiling|R-49
        apply_logic:
          - or:
            - ASHRAE IECC Climate Zone 2004|2A
            - ASHRAE IECC Climate Zone 2004|2B
            - ASHRAE IECC Climate Zone 2004|3A
            - ASHRAE IECC Climate Zone 2004|3B
            - ASHRAE IECC Climate Zone 2004|3C
          - Geometry Attic Type|Vented Attic
          - or:
            - Insulation Ceiling|Uninsulated
            - Insulation Ceiling|R-7
            - Insulation Ceiling|R-13
            - Insulation Ceiling|R-19
            - Insulation Ceiling|R-30
            - Insulation Ceiling|R-38
        costs:
          - value: 0.0482 # $/(ft^2 * Delta R-value), from original REMDB xlsx for blown cellulose (0.0154+0.019)
                          # apply inflation factor 1.4 (Jan 2010 to Apr 2023) to 0.0344 https://www.bls.gov/data/inflation_calculator.htm
            multiplier: Floor Area, Attic * Insulation Increase (ft^2 * Delta R-value)
          - value: 0.2163 # $/(ft^2), from original REMDB xlsx for blown cellulose (0.1505+0.004)
                          # apply inflation factor 1.4 (Jan 2010 to Apr 2023) to 0.1545
            multiplier: Floor Area, Attic (ft^2)
        lifetime: 60 # years effective useful life for opaque envelope components, from https://www.nyserda.ny.gov/-/media/Files/Programs/energy-code-training/Residential-Cost-Analysis-Report.pdf
      - &attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
        option: Insulation Ceiling|R-60
        apply_logic:
          - or:
            - ASHRAE IECC Climate Zone 2004|4A
            - ASHRAE IECC Climate Zone 2004|4B
            - ASHRAE IECC Climate Zone 2004|4C
            - ASHRAE IECC Climate Zone 2004|5A
            - ASHRAE IECC Climate Zone 2004|5B
            - ASHRAE IECC Climate Zone 2004|6A
            - ASHRAE IECC Climate Zone 2004|6B
            - ASHRAE IECC Climate Zone 2004|7A
            - ASHRAE IECC Climate Zone 2004|7B
          - Geometry Attic Type|Vented Attic
          - or:
            - Insulation Ceiling|Uninsulated
            - Insulation Ceiling|R-7
            - Insulation Ceiling|R-13
            - Insulation Ceiling|R-19
            - Insulation Ceiling|R-30
            - Insulation Ceiling|R-38
            - Insulation Ceiling|R-49
        costs:
          - value: 0.0482 # $/(ft^2 * Delta R-value), from original REMDB xlsx for blown cellulose (0.0154+0.019)
                          # apply inflation factor 1.4 (Jan 2010 to Apr 2023) to 0.0344 https://www.bls.gov/data/inflation_calculator.htm
            multiplier: Floor Area, Attic * Insulation Increase (ft^2 * Delta R-value)
          - value: 0.2163 # $/(ft^2), from original REMDB xlsx for blown cellulose (0.1505+0.004)
                          # apply inflation factor 1.4 (Jan 2010 to Apr 2023) to 0.1545
            multiplier: Floor Area, Attic (ft^2)
        lifetime: 60 # years effective useful life for opaque envelope components, from https://www.nyserda.ny.gov/-/media/Files/Programs/energy-code-training/Residential-Cost-Analysis-Report.pdf
      #General air sealing - 30% total reduction in ACH50 for homes with greater than 10 ACH50
      #30% is consistent with median reduction documented in https://doi.org/10.20357/B7FP4D 
      - &infiltration_30pct_reduction
        option: Infiltration Reduction|30%
        apply_logic:
          - or:
            - Infiltration|50 ACH50
            - Infiltration|40 ACH50
            - Infiltration|30 ACH50
            - Infiltration|25 ACH50
            - Infiltration|20 ACH50
            - Infiltration|18.5 ACH50
            - Infiltration|15 ACH50
            - Infiltration|11.25 ACH50
        costs:
          - value: 0.53 # from LBNL data for general air sealing (https://doi.org/10.20357/B7FP4D).
                        # Interpolated between 20% and 40% reductions to get $0.44/ft2,
                        # then used 1.2052 multiplier to inflate from Jan 2019 to April 2023 https://www.bls.gov/data/inflation_calculator.htm
            multiplier: Floor Area, Conditioned (ft^2)
        lifetime: 60 # years effective useful life for opaque envelope components, from https://www.nyserda.ny.gov/-/media/Files/Programs/energy-code-training/Residential-Cost-Analysis-Report.pdf


  - upgrade_name: EnergyStar ducted ASHP w/ elec backup - existing natural gas + light touch envelope   
    # Category 5, Measure 1 + Category 2, Measure 1
      #ASHP
    package_apply_logic: &ducted_ASHP_elec_backup_existing_NG
      - HVAC Has Ducts|Yes
      - Heating Fuel|Natural Gas

    options:
      - *ducted_ASHP_EnergyStar_elec_backup
      - *HP_cooling_efficiency_ducted
      - *100_percent_conditioned
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####


  - upgrade_name: EnergyStar ducted ASHP w/ elec backup - existing propane + light touch envelope  
    # Category 5, Measure 1 + Category 2, Measure 1
      #ASHP
    package_apply_logic: &ducted_ASHP_elec_backup_existing_propane
      - HVAC Has Ducts|Yes
      - Heating Fuel|Propane

    options:

      - *ducted_ASHP_EnergyStar_elec_backup
      - *HP_cooling_efficiency_ducted
      - *100_percent_conditioned
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####
  - upgrade_name: EnergyStar ducted ASHP w/ elec backup - existing fuel oil + light touch envelope  
    # Category 5, Measure 1 + Category 2, Measure 1
      #ASHP
    package_apply_logic: &ducted_ASHP_elec_backup_existing_FO
      - HVAC Has Ducts|Yes
      - Heating Fuel|Fuel Oil

    options:

      - *ducted_ASHP_EnergyStar_elec_backup
      - *HP_cooling_efficiency_ducted
      - *100_percent_conditioned
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####



  - upgrade_name: EnergyStar cold climate ducted ASHP w/ elec backup - existing elec + light touch envelope 
    # Category 5, Measure 2 + Category 2, Measure 1
    package_apply_logic: *ducted_ASHP_elec_backup_existing_elec
    options:
      #ASHP
      - &ducted_ASHP_EnergyStarCC_elec_backup
        option: HVAC Heating Efficiency|ASHP, SEER 16, 9.5 HSPF, CCHP, Max Load
        costs: &costs_ashp_ducted_SEER_16_9-5_HSPF
        # Source: Custom regression by Brennan Less. Ducted heat pump project costs were regressed on nameplate tons and HSPF,
        # from data described in in Less et al. https://doi.org/10.20357/B7FP4D. January 2019 $ inflated to April 2023 $ using 1.21 factor.
        # Ducted ASHP regression n=317. Implicitly includes electrical upgrades and electric backup.
          - value: 5723.12 # for HSPF 9.5
            multiplier: Fixed (1)
          - value: 167.64
            multiplier: Size, Heating System Primary (kBtu/h)
        lifetime: *lifetime_ducted_ASHP_elec_backup

      - *HP_cooling_efficiency_ducted
      - *100_percent_conditioned

      - &cooling_setpoint_no_offset
        option: Cooling Setpoint Has Offset|No

      - &cooling_setpoint_offset_magnitude_0
        option: Cooling Setpoint Offset Magnitude|0F
      
      - &cooling_setpoint_offset_period_none
        option: Cooling Setpoint Offset Period|None

      - &heating_setpoint_no_offset
        option: Heating Setpoint Has Offset|No

      - &heating_setpoint_offset_magnitude_0
        option: Heating Setpoint Offset Magnitude|0F
      
      - &heating_setpoint_offset_period_none
        option: Heating Setpoint Offset Period|None
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####

  - upgrade_name: EnergyStar cold climate ducted ASHP w/ elec backup - existing natural gas + light touch envelope  
    # Category 5, Measure 2 + Category 2, Measure 1
    package_apply_logic: *ducted_ASHP_elec_backup_existing_NG
    options:
      #ASHP
      - *ducted_ASHP_EnergyStarCC_elec_backup

      - *HP_cooling_efficiency_ducted
      - *100_percent_conditioned

      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0     
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0      
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####

  - upgrade_name: EnergyStar cold climate ducted ASHP w/ elec backup - existing propane + light touch envelope  
    # Category 5, Measure 2 + Category 2, Measure 1
    package_apply_logic: *ducted_ASHP_elec_backup_existing_propane
    options:
      #ASHP
      - *ducted_ASHP_EnergyStarCC_elec_backup

      - *HP_cooling_efficiency_ducted
      - *100_percent_conditioned

      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0     
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0      
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####

  - upgrade_name: EnergyStar cold climate ducted ASHP w/ elec backup - existing fuel oil + light touch envelope  
    # Category 5, Measure 2 + Category 2, Measure 1
    package_apply_logic: *ducted_ASHP_elec_backup_existing_FO
    options:
      #ASHP
      - *ducted_ASHP_EnergyStarCC_elec_backup

      - *HP_cooling_efficiency_ducted
      - *100_percent_conditioned
      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0     
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0      
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####

  - upgrade_name: Higher efficiency ducted ASHP w/ elec backup - existing elec + light touch envelope 
    # Category 5, Measure 3 + Category 2, Measure 1
    package_apply_logic: *ducted_ASHP_elec_backup_existing_elec
    options:
      #ASHP
      - &ducted_ASHP_HigherEfficiency_elec_backup
        option: HVAC Heating Efficiency|ASHP, SEER 20, 11 HSPF, CCHP, Max Load 
        costs: &costs_ashp_ducted_SEER_20_11_HSPF
        # Source: Custom regression by Brennan Less. Ducted heat pump project costs were regressed on nameplate tons and HSPF,
        # from data described in in Less et al. https://doi.org/10.20357/B7FP4D. January 2019 $ inflated to April 2023 $ using 1.21 factor.
        # Ducted ASHP regression n=317. Implicitly includes electrical upgrades and electric backup.
          - value: 10229.58 # for HSPF 11
            multiplier: Fixed (1)
          - value: 167.64
            multiplier: Size, Heating System Primary (kBtu/h)
        lifetime: *lifetime_ducted_ASHP_elec_backup

      - *HP_cooling_efficiency_ducted
      - *100_percent_conditioned
      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####

  - upgrade_name: Higher efficiency ducted ASHP w/ elec backup - existing natural gas + light touch envelope 
    # Category 5, Measure 3 + Category 2, Measure 1
    package_apply_logic: *ducted_ASHP_elec_backup_existing_NG
    options:
      #ASHP
      - *ducted_ASHP_HigherEfficiency_elec_backup

      - *HP_cooling_efficiency_ducted
      - *100_percent_conditioned
      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####


  - upgrade_name: Higher efficiency ducted ASHP w/ elec backup - existing propane + light touch envelope 
    # Category 5, Measure 3 + Category 2, Measure 1
    package_apply_logic: *ducted_ASHP_elec_backup_existing_propane
    options:
      #ASHP
      - *ducted_ASHP_HigherEfficiency_elec_backup

      - *HP_cooling_efficiency_ducted
      - *100_percent_conditioned
      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####

  - upgrade_name: Higher efficiency ducted ASHP w/ elec backup - existing fuel oil + light touch envelope 
    # Category 5, Measure 3 + Category 2, Measure 1
    package_apply_logic: *ducted_ASHP_elec_backup_existing_FO
    options:
      #ASHP
      - *ducted_ASHP_HigherEfficiency_elec_backup

      - *HP_cooling_efficiency_ducted
      - *100_percent_conditioned
      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####


  - upgrade_name: EnergyStar ductless MSHP w/ elec backup - existing elec + light touch envelope 
    # Category 5, Measure 4 + Category 2, Measure 1
    package_apply_logic: &ductless_MSHP_elec_backup_existing_elec
      - HVAC Has Ducts|No
      - Heating Fuel|Electricity
      - or: &not_MSHP_greater_than_SEER_16_9-2_HSPF
        - not: HVAC Cooling Efficiency|Non-Ducted Heat Pump
        - HVAC Heating Efficiency|MSHP, SEER 14.5, 8.2 HSPF
    options:
      # MSHP
      - &ductless_MSHP_EnergyStar_elec_backup
        option: HVAC Heating Efficiency|MSHP, SEER 16, 9.2 HSPF, Max Load 
        costs: &costs_mshp_ductless_SEER_16_9-2_HSPF
        # Source: Custom regression by Brennan Less. Ductless heat pump project costs were regressed on nameplate tons,
        # from data described in in Less et al. https://doi.org/10.20357/B7FP4D. January 2019 $ inflated to April 2023 $ using 1.21 factor.
        # Ductless MSHP n=173, HSPF median 11, range 9.3–14.2. Implicitly includes multiple zones and electrical upgrades.
        # Regression results in costs that are 15–30% higher than costs from The Heat Pump Store as documented in https://redwoodenergy.net/wp-content/uploads/2021/02/Pocket-Guide-to-All-Electric-Retrofits-of-Single-Family-Homes.pdf 
        # LBNL data were not sufficient to include a relationship between SEER or HSPF and cost, so cost deltas for higher 
        # and lower HSPF were added using the relationship between HSPF and cost for ductless MSHPs in REMDB: 2.2% addition or subtraction per point
        # according to how many points above or below the HSPF rating is from 10.5 (https://remdb.nrel.gov/).
          - value: 2733.38
            multiplier: Fixed (1)
          - value: 354.96
            multiplier: Size, Heating System Primary (kBtu/h)
        lifetime: &lifetime_ductless_MSHP_elec_backup 
          15

      - &HP_cooling_efficiency_nonducted
        option: HVAC Cooling Efficiency|Non-Ducted Heat Pump

      - *100_percent_conditioned
      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####

  - upgrade_name: EnergyStar ductless MSHP w/ elec backup - existing natural gas + light touch envelope 
    # Category 5, Measure 4 + Category 2, Measure 1
    package_apply_logic: &ductless_MSHP_elec_backup_existing_NG
      - HVAC Has Ducts|No
      - Heating Fuel|Natural Gas


    options:
      # MSHP
      - *ductless_MSHP_EnergyStar_elec_backup

      - *HP_cooling_efficiency_nonducted
      - *100_percent_conditioned
      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####

  - upgrade_name: EnergyStar ductless MSHP w/ elec backup - existing propane + light touch envelope 
    # Category 5, Measure 4 + Category 2, Measure 1
    package_apply_logic: &ductless_MSHP_elec_backup_existing_propane
      - HVAC Has Ducts|No
      - Heating Fuel|Propane

    options:
      # MSHP
      - *ductless_MSHP_EnergyStar_elec_backup

      - *HP_cooling_efficiency_nonducted
      - *100_percent_conditioned
      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####

  - upgrade_name: EnergyStar ductless MSHP w/ elec backup - existing fuel oil + light touch envelope 
    # Category 5, Measure 4 + Category 2, Measure 1
    package_apply_logic: &ductless_MSHP_elec_backup_existing_FO
      - HVAC Has Ducts|No
      - Heating Fuel|Fuel Oil

    options:
      # MSHP
      - *ductless_MSHP_EnergyStar_elec_backup

      - *HP_cooling_efficiency_nonducted
      - *100_percent_conditioned
      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####

  - upgrade_name: EnergyStar cold climate ductless MSHP w/ elec backup - existing elec + light touch envelope 
    # Category 5, Measure 5 + Category 2, Measure 1
    package_apply_logic: *ductless_MSHP_elec_backup_existing_elec
    options:
      # MSHP
      - &ductless_MSHP_EnergyStarCC_elec_backup
        option: HVAC Heating Efficiency|MSHP, SEER 16, 9.5 HSPF, CCHP, Max Load 
        costs: &costs_mshp_ductless_SEER_16_9-5_HSPF
        # Source: Custom regression by Brennan Less. Ductless heat pump project costs were regressed on nameplate tons,
        # from data described in in Less et al. https://doi.org/10.20357/B7FP4D. January 2019 $ inflated to April 2023 $ using 1.21 factor.
        # Ductless MSHP n=173, HSPF median 11, range 9.3–14.2. Implicitly includes multiple zones and electrical upgrades.
        # Regression results in costs that are 15–30% higher than costs from The Heat Pump Store as documented in https://redwoodenergy.net/wp-content/uploads/2021/02/Pocket-Guide-to-All-Electric-Retrofits-of-Single-Family-Homes.pdf 
        # LBNL data were not sufficient to include a relationship between SEER or HSPF and cost, so cost deltas for higher 
        # and lower HSPF were added using the relationship between HSPF and cost for ductless MSHPs in REMDB: 2.2% addition or subtraction per point
        # according to how many points above or below the HSPF rating is from 10.5 (https://remdb.nrel.gov/).
          - value: 2751.95
            multiplier: Fixed (1)
          - value: 357.37
            multiplier: Size, Heating System Primary (kBtu/h)
        lifetime: *lifetime_ductless_MSHP_elec_backup 

      - *HP_cooling_efficiency_nonducted
      - *100_percent_conditioned
      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####
  - upgrade_name: EnergyStar cold climate ductless MSHP w/ elec backup - existing natural gas + light touch envelope
    # Category 5, Measure 5 + Category 2, Measure 1
    package_apply_logic: *ductless_MSHP_elec_backup_existing_NG
    options:
      # MSHP
      - *ductless_MSHP_EnergyStarCC_elec_backup

      - *HP_cooling_efficiency_nonducted
      - *100_percent_conditioned
      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####

  - upgrade_name: EnergyStar cold climate ductless MSHP w/ elec backup - existing propane + light touch envelope 
    # Category 5, Measure 5 + Category 2, Measure 1
    package_apply_logic: *ductless_MSHP_elec_backup_existing_propane
    options:
      # MSHP
      - *ductless_MSHP_EnergyStarCC_elec_backup

      - *HP_cooling_efficiency_nonducted
      - *100_percent_conditioned
      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####

  - upgrade_name: EnergyStar cold climate ductless MSHP w/ elec backup - existing fuel oil + light touch envelope 
    # Category 5, Measure 5 + Category 2, Measure 1
    package_apply_logic: *ductless_MSHP_elec_backup_existing_FO
    options:
      # MSHP
      - *ductless_MSHP_EnergyStarCC_elec_backup

      - *HP_cooling_efficiency_nonducted
      - *100_percent_conditioned
      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####

  - upgrade_name: Higher efficiency ductless MSHP w/ elec backup - existing elec + light touch envelope 
    # Category 5, Measure 6 + Category 2, Measure 1
    package_apply_logic: *ductless_MSHP_elec_backup_existing_elec
    options:
      # MSHP
      - &ductless_MSHP_HigherEfficiency_elec_backup
        option: HVAC Heating Efficiency|MSHP, SEER 20, 11 HSPF, CCHP, Max Load 
        costs: &costs_mshp_ductless_SEER_20_11_HSPF
        # Source: Custom regression by Brennan Less. Ductless heat pump project costs were regressed on nameplate tons,
        # from data described in in Less et al. https://doi.org/10.20357/B7FP4D. January 2019 $ inflated to April 2023 $ using 1.21 factor.
        # Ductless MSHP n=173, HSPF median 11, range 9.3–14.2. Implicitly includes multiple zones and electrical upgrades.
        # Regression results in costs that are 15–30% higher than costs from The Heat Pump Store as documented in https://redwoodenergy.net/wp-content/uploads/2021/02/Pocket-Guide-to-All-Electric-Retrofits-of-Single-Family-Homes.pdf 
        # LBNL data were not sufficient to include a relationship between SEER or HSPF and cost, so cost deltas for higher 
        # and lower HSPF were added using the relationship between HSPF and cost for ductless MSHPs in REMDB: 2.2% addition or subtraction per point
        # according to how many points above or below the HSPF rating is from 10.5 (https://remdb.nrel.gov/).
          - value: 2844.81
            multiplier: Fixed (1)
          - value: 369.43
            multiplier: Size, Heating System Primary (kBtu/h)
        lifetime: *lifetime_ductless_MSHP_elec_backup 

      - *HP_cooling_efficiency_nonducted
      - *100_percent_conditioned
      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####

  - upgrade_name: Higher efficiency ductless MSHP w/ elec backup - existing natural gas + light touch envelope
    # Category 5, Measure 6 + Category 2, Measure 1
    package_apply_logic: *ductless_MSHP_elec_backup_existing_NG
    options:
      # MSHP
      - *ductless_MSHP_HigherEfficiency_elec_backup

      - *HP_cooling_efficiency_nonducted
      - *100_percent_conditioned
      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####
      
  - upgrade_name: Higher efficiency ductless MSHP w/ elec backup - existing propane + light touch envelope 
    # Category 5, Measure 6 + Category 2, Measure 1
    package_apply_logic: *ductless_MSHP_elec_backup_existing_propane
    options:
      # MSHP
      - *ductless_MSHP_HigherEfficiency_elec_backup

      - *HP_cooling_efficiency_nonducted
      - *100_percent_conditioned
      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####

  - upgrade_name: Higher efficiency ductless MSHP w/ elec backup - existing fuel oil + light touch envelope 
    # Category 5, Measure 6 + Category 2, Measure 1
    package_apply_logic: *ductless_MSHP_elec_backup_existing_FO
    options:
      # MSHP
      - *ductless_MSHP_HigherEfficiency_elec_backup

      - *HP_cooling_efficiency_nonducted
      - *100_percent_conditioned
      - *cooling_setpoint_no_offset
      - *cooling_setpoint_offset_magnitude_0
      - *cooling_setpoint_offset_period_none
      - *heating_setpoint_no_offset
      - *heating_setpoint_offset_magnitude_0
      - *heating_setpoint_offset_period_none
      ####
      # Light Touch Envelope:
      - *attic_insulation_IECC_CZ1A
      - *attic_insulation_IECC_CZ2A-2B-3A-3B-3C
      - *attic_insulation_IECC_CZ4A-4B-4C-5A-5B-6A-6B-7A-7B
      - *infiltration_30pct_reduction
      ####