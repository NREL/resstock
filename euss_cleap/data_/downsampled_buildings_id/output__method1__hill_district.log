2023-06-21 15:16:47,805 - INFO - ---------------------------------------------------------
2023-06-21 15:16:47,806 - INFO - Downsampling buildstock for  hill_district  using method 1
2023-06-21 15:16:47,806 - INFO - ---------------------------------------------------------
2023-06-21 15:16:47,904 - INFO - Creating n>=1000 buildlstock by downsampling from: bst_to_search (548916 samples) 
while matching the marginal distribution of 13 key HCs from: bst_to_match (399 samples), 
['Income', 'ASHRAE IECC Climate Zone 2004', 'State', 'Geometry Building Type RECS', 'Heating Fuel', 'HVAC Cooling Type', 'Tenure', 'Water Heater Fuel', 'Vintage ACS', 'Geometry Floor Area Bin', 'HVAC Heating Type', 'Federal Poverty Level', 'Vacancy Status']
2023-06-21 15:16:47,905 - INFO - 
2023-06-21 15:16:47,906 - INFO - 
---- Attempt 1: downsample using 13 key HCs: ----
2023-06-21 15:16:48,067 - INFO -    Located 13940 positively weighted rows in bst_to_search
2023-06-21 15:16:48,067 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2023-06-21 15:16:48,154 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 860 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.vacancy_status...
2023-06-21 15:16:48,154 - INFO - 
---- Attempt 2: downsample using 12 key HCs: ----
2023-06-21 15:16:48,162 - INFO -    Located 13940 positively weighted rows in bst_to_search
2023-06-21 15:16:48,162 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2023-06-21 15:16:48,219 - INFO -    Downsampling FAILED with insufficient rows: Recalculation leads to 971 positively weighted samples 
retry by relaxing HC_to_search by removing: build_existing_model.federal_poverty_level...
2023-06-21 15:16:48,219 - INFO - 
---- Attempt 3: downsample using 11 key HCs: ----
2023-06-21 15:16:48,232 - INFO -    Located 13940 positively weighted rows in bst_to_search
2023-06-21 15:16:48,233 - INFO - 
 -> Step 2 : Weight Recalculation
Method 1A - normalizing to exact joint-prob from bst_to_match ...
2023-06-21 15:16:48,294 - INFO - 

** Downsampled to: 1332 samples, by matching to: ['build_existing_model.income', 'build_existing_model.ashrae_iecc_climate_zone_2004', 'build_existing_model.state', 'build_existing_model.geometry_building_type_recs', 'build_existing_model.heating_fuel', 'build_existing_model.hvac_cooling_type', 'build_existing_model.tenure', 'build_existing_model.water_heater_fuel', 'build_existing_model.vintage_acs', 'build_existing_model.geometry_floor_area_bin', 'build_existing_model.hvac_heating_type']
2023-06-21 15:16:48,310 - INFO - 
 -> Step 3 : Weight Normalization
2023-06-21 15:16:48,312 - INFO - Checking marginals from weight_map of n=1332...
2023-06-21 15:16:48,317 - INFO -  [[ build_existing_model.income ]] 
2023-06-21 15:16:48,324 - INFO - 
                matched     truth  pct_diff
10000-14999    0.062657  0.062657       0.0
100000-119999  0.045113  0.045113       0.0
120000-139999  0.042607  0.042607       0.0
140000-159999  0.022556  0.022556       0.0
15000-19999    0.062657  0.062657       0.0
160000-179999  0.025063  0.025063       0.0
180000-199999  0.007519  0.007519       0.0
20000-24999    0.060150  0.060150       0.0
200000+        0.080201  0.080201       0.0
25000-29999    0.050125  0.050125       0.0
30000-34999    0.050125  0.050125       0.0
35000-39999    0.037594  0.037594       0.0
40000-44999    0.030075  0.030075       0.0
45000-49999    0.017544  0.017544       0.0
50000-59999    0.075188  0.075188       0.0
60000-69999    0.047619  0.047619       0.0
70000-79999    0.047619  0.047619       0.0
80000-99999    0.085213  0.085213       0.0
<10000         0.150376  0.150376       0.0

2023-06-21 15:16:48,352 - INFO -  [[ build_existing_model.ashrae_iecc_climate_zone_2004 ]] 
2023-06-21 15:16:48,379 - INFO - 
    matched  truth  pct_diff
5A      1.0    1.0       0.0

2023-06-21 15:16:48,408 - INFO -  [[ build_existing_model.state ]] 
2023-06-21 15:16:48,431 - INFO - 
    matched  truth  pct_diff
PA      1.0    1.0       0.0

2023-06-21 15:16:48,437 - INFO -  [[ build_existing_model.geometry_building_type_recs ]] 
2023-06-21 15:16:48,448 - INFO - 
                                matched     truth  pct_diff
Mobile Home                    0.002506  0.002506       0.0
Multi-Family with 2 - 4 Units  0.167920  0.167920       0.0
Multi-Family with 5+ Units     0.328321  0.328321       0.0
Single-Family Attached         0.167920  0.167920       0.0
Single-Family Detached         0.333333  0.333333       0.0

2023-06-21 15:16:48,454 - INFO -  [[ build_existing_model.heating_fuel ]] 
2023-06-21 15:16:48,460 - INFO - 
              matched     truth  pct_diff
Electricity  0.228070  0.228070       0.0
Fuel Oil     0.005013  0.005013       0.0
Natural Gas  0.749373  0.749373       0.0
None         0.002506  0.002506       0.0
Propane      0.015038  0.015038       0.0

2023-06-21 15:16:48,466 - INFO -  [[ build_existing_model.hvac_cooling_type ]] 
2023-06-21 15:16:48,470 - INFO - 
             matched     truth  pct_diff
Central AC  0.348371  0.348371       0.0
Heat Pump   0.042607  0.042607       0.0
None        0.215539  0.215539       0.0
Room AC     0.393484  0.393484       0.0

2023-06-21 15:16:48,474 - INFO -  [[ build_existing_model.tenure ]] 
2023-06-21 15:16:48,479 - INFO - 
         matched     truth  pct_diff
Owner   0.406015  0.406015       0.0
Renter  0.593985  0.593985       0.0

2023-06-21 15:16:48,483 - INFO -  [[ build_existing_model.water_heater_fuel ]] 
2023-06-21 15:16:48,488 - INFO - 
              matched     truth  pct_diff
Electricity  0.223058  0.223058       0.0
Fuel Oil     0.027569  0.027569       0.0
Natural Gas  0.736842  0.736842       0.0
Propane      0.012531  0.012531       0.0

2023-06-21 15:16:48,494 - INFO -  [[ build_existing_model.vintage_acs ]] 
2023-06-21 15:16:48,500 - INFO - 
          matched     truth  pct_diff
1940-59  0.175439  0.175439       0.0
1960-79  0.160401  0.160401       0.0
1980-99  0.092732  0.092732       0.0
2000-09  0.037594  0.037594       0.0
2010s    0.030075  0.030075       0.0
<1940    0.503759  0.503759       0.0

2023-06-21 15:16:48,505 - INFO -  [[ build_existing_model.geometry_floor_area_bin ]] 
2023-06-21 15:16:48,509 - INFO - 
            matched     truth  pct_diff
0-1499     0.671679  0.671679       0.0
1500-2499  0.208020  0.208020       0.0
2500-3999  0.080201  0.080201       0.0
4000+      0.040100  0.040100       0.0

2023-06-21 15:16:48,515 - INFO -  [[ build_existing_model.hvac_heating_type ]] 
2023-06-21 15:16:48,521 - INFO - 
                     matched     truth  pct_diff
Ducted Heat Pump    0.042607  0.042607       0.0
Ducted Heating      0.558897  0.558897       0.0
Non-Ducted Heating  0.395990  0.395990       0.0
None                0.002506  0.002506       0.0

2023-06-21 15:16:48,521 - INFO - For unmatched HC:
2023-06-21 15:16:48,522 - INFO - Checking marginals from weight_map of n=1332...
2023-06-21 15:16:48,528 - INFO -  [[ build_existing_model.federal_poverty_level ]] 
2023-06-21 15:16:48,534 - INFO - 
           matched     truth   pct_diff
0-100%    0.237838  0.230576   3.149155
100-150%  0.101814  0.115288 -11.687371
150-200%  0.072721  0.065163  11.598387
200-300%  0.134568  0.142857  -5.802472
300-400%  0.095606  0.097744  -2.187751
400%+     0.357454  0.348371   2.607208

2023-06-21 15:16:48,539 - INFO -  [[ build_existing_model.vacancy_status ]] 
2023-06-21 15:16:48,543 - INFO - 
           matched     truth   pct_diff
Occupied  0.869248  0.882206  -1.468812
Vacant    0.130752  0.117794  11.000461

2023-06-21 15:16:48,564 - INFO - truth vs. matched - per dwelling unit energy:
2023-06-21 15:16:48,571 - INFO - 
                                     matched       truth   pct_diff
energy_use_total_m_btu            103.945205  105.774198  -1.729149
fuel_use_electricity_total_m_btu   27.757594   28.236371  -1.695604
fuel_use_fuel_oil_total_m_btu       0.675655    0.788015 -14.258646
fuel_use_natural_gas_total_m_btu   74.420331   75.662519  -1.641747
fuel_use_propane_total_m_btu        1.091634    1.087303   0.398320

2023-06-21 15:16:48,591 - INFO - truth vs. matched - per dwelling unit energy:
2023-06-21 15:16:48,596 - INFO - 
                                                                         matched       truth   pct_diff
build_existing_model.vacancy_status                                                                    
Occupied                            energy_use_total_m_btu            112.394124  113.691801  -1.141399
                                    fuel_use_electricity_total_m_btu   30.233765   30.426565  -0.633657
                                    fuel_use_fuel_oil_total_m_btu       0.763929    0.880071 -13.196918
                                    fuel_use_natural_gas_total_m_btu   80.290223   81.300122  -1.242187
                                    fuel_use_propane_total_m_btu        1.106223    1.085065   1.949887
Vacant                              energy_use_total_m_btu             47.776439   46.476404   2.797192
                                    fuel_use_electricity_total_m_btu   11.295902   11.833213  -4.540702
                                    fuel_use_fuel_oil_total_m_btu       0.088805    0.098574  -9.910284
                                    fuel_use_natural_gas_total_m_btu   35.397046   33.440468   5.850930
                                    fuel_use_propane_total_m_btu        0.994648    1.104064  -9.910284

2023-06-21 15:16:48,608 - INFO - truth vs. matched - per dwelling unit energy:
2023-06-21 15:16:48,614 - INFO - 
                                                                 matched       truth   pct_diff
build_existing_model.tenure                                                                    
Owner                       energy_use_total_m_btu            152.279911  157.251877  -3.161784
                            fuel_use_electricity_total_m_btu   31.966630   32.763105  -2.431013
                            fuel_use_fuel_oil_total_m_btu       0.655100    0.931840 -29.698161
                            fuel_use_natural_gas_total_m_btu  118.942649  122.841401  -3.173810
                            fuel_use_propane_total_m_btu        0.715506    0.715506  -0.000000
Renter                      energy_use_total_m_btu             70.906291   70.586924   0.452446
                            fuel_use_electricity_total_m_btu   24.880531   25.142148  -1.040549
                            fuel_use_fuel_oil_total_m_btu       0.689705    0.689705  -0.000000
                            fuel_use_natural_gas_total_m_btu   43.987355   43.413662   1.321456
                            fuel_use_propane_total_m_btu        1.348734    1.341443   0.543544

2023-06-21 15:16:48,624 - INFO - truth vs. matched - per dwelling unit energy:
2023-06-21 15:16:48,630 - INFO - 
                                                                                matched       truth   pct_diff
build_existing_model.federal_poverty_level                                                                    
0-100%                                     energy_use_total_m_btu             79.802003   81.240783  -1.771006
                                           fuel_use_electricity_total_m_btu   25.597855   26.243522  -2.460289
                                           fuel_use_fuel_oil_total_m_btu       0.676996    0.698315  -3.053011
                                           fuel_use_natural_gas_total_m_btu   52.560748   53.314402  -1.413603
                                           fuel_use_propane_total_m_btu        0.966408    0.984543  -1.841993
100-150%                                   energy_use_total_m_btu            100.585843  108.976783  -7.699750
                                           fuel_use_electricity_total_m_btu   26.343451   28.721326  -8.279126
                                           fuel_use_fuel_oil_total_m_btu       0.287418    0.253826  13.234087
                                           fuel_use_natural_gas_total_m_btu   70.538043   77.003587  -8.396419
                                           fuel_use_propane_total_m_btu        3.416987    2.998109  13.971411
150-200%                                   energy_use_total_m_btu             93.603400   86.108038   8.704601
                                           fuel_use_electricity_total_m_btu   29.548919   28.195885   4.798696
                                           fuel_use_fuel_oil_total_m_btu       0.809531    0.903423 -10.392970
                                           fuel_use_natural_gas_total_m_btu   63.130494   56.917423  10.915938
                                           fuel_use_propane_total_m_btu        0.114398    0.091192  25.447322
200-300%                                   energy_use_total_m_btu            107.434753  110.880982  -3.108044
                                           fuel_use_electricity_total_m_btu   28.433353   28.774491  -1.185557
                                           fuel_use_fuel_oil_total_m_btu       0.139852    0.131737   6.159898
                                           fuel_use_natural_gas_total_m_btu   78.831916   81.918614  -3.768006
                                           fuel_use_propane_total_m_btu        0.029610    0.056105 -47.224345
300-400%                                   energy_use_total_m_btu            102.804686  114.022974  -9.838621
                                           fuel_use_electricity_total_m_btu   31.752205   33.871103  -6.255767
                                           fuel_use_fuel_oil_total_m_btu       0.300209    0.293641   2.236684
                                           fuel_use_natural_gas_total_m_btu   67.633543   76.817872 -11.955979
                                           fuel_use_propane_total_m_btu        3.118782    3.040436   2.576821
400%+                                      energy_use_total_m_btu            122.061442  120.222302   1.529782
                                           fuel_use_electricity_total_m_btu   27.910162   27.600827   1.120743
                                           fuel_use_fuel_oil_total_m_btu       1.060237    1.410410 -24.827755
                                           fuel_use_natural_gas_total_m_btu   92.522002   90.626935   2.091063
                                           fuel_use_propane_total_m_btu        0.569055    0.584151  -2.584290

2023-06-21 15:16:48,636 - INFO - >> Database down-selected to 1332 buildings, based on input data of 399 buildings, result outputs to: 
/Users/lliu2/Documents/GitHub/ResStock/euss_cleap/data_/downsampled_buildings_id/euss1_2018_results_up00__downsampled_method1__hill_district.csv

